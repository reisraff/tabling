var tabling=function(e){var t=this;return t.elementId=e.elementId||"",t.endingpointUrl=e.endingpointUrl||"",t.columns=[],t.paginator=e.paginator||{},t.paginator.numberOfPages=t.paginator.numberOfPages||5,t.paginator.firstLast=t.paginator.firstLast||!0,t.paginator.prevNext=t.paginator.prevNext||!0,t.paginator.classWhenActive=t.paginator.classWhenActived||"active",t.paginator.classWhenDisabled=t.paginator.classWhenDisabled||"disabled",t.pagination={currentPage:0,totalPages:0},t.sorting=e.sorting||{},t.sorting.ascClass=t.sorting.ascClass||"tabling-sort-asc",t.sorting.descClass=t.sorting.descClass||"tabling-sort-desc",t.sorting.noneClass=t.sorting.noneClass||"tabling-sort-none",t.dataSort=[],t.listeners=[],t.formatters=[],t.requestHandler=function(){return{}},t.responseHandler=function(e){},t.paginationHandler=function(e){},t.sortingHandler=function(e){},t.flush=function(){t.lineParent.innerHTML=""},t.handleEvent=function(e){for(var t=listeners.length-1;t>=0;t--)listeners[t].e==e.type&&listeners[t].c(e.target,e)},t.request=function(){var e=new XMLHttpRequest;e.open("POST",t.endingpointUrl,!0);var n=t.requestHandler();if(void 0!=n.headers&&null!=n.headers)for(var a=n.headers.length-1;a>=0;a--)e.setRequestHeader(n.headers[a].header,n.headers[a].value);e.onreadystatechange=function(){4==e.readyState&&200==e.status&&t.responseHandler(e.responseText)},e.send(JSON.stringify(n.data))},t.addLine=function(e){var n=t.line.cloneNode(!0);Object.keys(e).map(function(a){var r=n.querySelector("*[column-id="+a+"]");if(null!==r)if(r.innerHTML.match(/%data%/))r.innerHTML=r.innerHTML.replace(/%data%/,e[a].trim());else if(null!=r.getAttribute("formatter")&&void 0!=r.getAttribute("formatter"))for(var i=t.formatters.length-1;i>=0;i--)t.formatters[i].f==r.getAttribute("formatter")&&(r.innerHTML=t.formatters[i].c(e[a]));else r.innerHTML=e[a]});for(var a="",r=0;r<n.children.length;r++)for(var i=n.children[r];a=i.innerHTML.match(/%([a-zA-Z0-9-_]+)%/);){var s=n.querySelector("*[column-id="+a[1]+"]");i.innerHTML=null!==s?i.innerHTML.replace(a[0],s.innerHTML):i.innerHTML.replace(a[0],"")}t.columns.map(function(e){var t=n.querySelector("*[column-id="+e+"]");void 0!==t&&null!==t&&(t.style.display="none")}),t.lineParent.appendChild(n)},t.addLines=function(e){for(var n=0;n<e.length;n++)t.addLine(e[n])},t.on=function(e,n){if("function"!=typeof n)throw new Error("It is not a funcitons");t.listeners.push({e:e,c:n})},t.addFormatter=function(e,n){if("function"!=typeof n)throw new Error("It is not a funcitons");t.formatters.push({f:e,c:n})},t.updatePagination=function(){for(var e=t.page.parentNode.querySelectorAll("*[dinamic-page]"),n=e.length-1;n>=0;n--)e[n].remove();var a=Math.floor(t.paginator.numberOfPages/2);center=t.paginator.numberOfPages%2!=0?a+1:a;var r=1;if(t.pagination.currentPage>center&&(r=t.pagination.currentPage-a+t.paginator.numberOfPages-1>t.pagination.totalPages?t.pagination.totalPages-t.paginator.numberOfPages+1:t.pagination.currentPage-a),t.paginator.firstLast){var i=t.page.parentNode.querySelector("*[first-page]");1==t.pagination.currentPage?i.classList.add(t.paginator.classWhenDisabled):i.classList.remove(t.paginator.classWhenDisabled);var s=t.page.parentNode.querySelector("*[last-page]");t.pagination.currentPage==t.pagination.totalPages?s.classList.add(t.paginator.classWhenDisabled):s.classList.remove(t.paginator.classWhenDisabled)}if(t.paginator.prevNext){var o=t.page.parentNode.querySelector("*[prev-page]");t.pagination.currentPage-1<1?o.classList.add(t.paginator.classWhenDisabled):o.classList.remove(t.paginator.classWhenDisabled);var l=t.page.parentNode.querySelector("*[next-page]");t.pagination.currentPage+1>t.pagination.totalPages?l.classList.add(t.paginator.classWhenDisabled):l.classList.remove(t.paginator.classWhenDisabled)}for(var n=r;n<r+t.paginator.numberOfPages;n++)!function(){var e=t.pageClone.cloneNode(!0);if(e.setAttribute("dinamic-page","true"),n>t.pagination.totalPages)e.innerHTML=e.innerHTML.replace("%page%","-"),e.classList.add(t.paginator.classWhenDisabled);else{e.innerHTML=e.innerHTML.replace("%page%",n),n==t.pagination.currentPage&&e.classList.add(t.paginator.classWhenActive);var a=n;e.addEventListener("click",function(){t.paginate(a)})}t.page.parentNode.insertBefore(e,t.page)}()},t.paginate=function(e){var n=t.pagination.currentPage;switch(e){case"first":n=1;break;case"last":n=t.pagination.totalPages;break;case"next":n=++n;break;case"prev":n=--n;break;default:n=e}n>0&&n<=t.pagination.totalPages&&t.paginationHandler(n)},t.doSort=function(e){var n=e.getAttribute("sort-direction"),a=e.getAttribute("column-id");if(null!=a&&""!=a){var r=null;Object.keys(t.dataSort).map(function(e){t.dataSort[e].column==a&&(r=e)}),null==r&&(t.dataSort.push({column:a,direction:"asc"}),r=t.dataSort.length-1),""==n||null==n?(e.setAttribute("sort-direction","asc"),e.classList.remove(t.sorting.noneClass),e.classList.remove(t.sorting.descClass),e.classList.add(t.sorting.ascClass),t.dataSort[r].direction="asc"):"asc"==n?(e.setAttribute("sort-direction","desc"),e.classList.remove(t.sorting.noneClass),e.classList.remove(t.sorting.ascClass),e.classList.add(t.sorting.descClass),t.dataSort[r].direction="desc"):(e.setAttribute("sort-direction",""),e.classList.remove(t.sorting.descClass),e.classList.remove(t.sorting.ascClass),e.classList.add(t.sorting.noneClass),t.dataSort.splice(r,1))}t.sortingHandler(t.dataSort)},t.hideColumn=function(e){for(var n=t.table.querySelectorAll("*[column-id="+e+"]"),a=n.length-1;a>=0;a--)n[a].style.display="none";t.columns.push(e)},t.showColumn=function(e){for(var n=t.table.querySelectorAll("*[column-id="+e+"]"),a=n.length-1;a>=0;a--)n[a].style.display="";t.columns=t.columns.filter(function(t){return t!==e})},function(){if(t.table=document.getElementById(t.elementId),!t.table)throw new Error("Does not exists element with this ID.");t.line=t.table.querySelector("*[line]"),t.lineParent=t.line.parentNode,t.flush();for(var e=t.table.querySelectorAll("*[handle-event]"),n=e.length-1;n>=0;n--){var a=e[n],r=a.getAttribute("handle-event");if(""===r)for(var i in a)0===i.search("on")&&a.addEventListener(i.slice(2),t.handleEvent);else r.split(",").map(function(e){a.addEventListener(e,t.handleEvent)})}for(var e=t.table.querySelectorAll("*[sortable]"),n=e.length-1;n>=0;n--){var a=e[n];a.classList.add(t.sorting.noneClass),a.addEventListener("click",function(e){t.doSort(e.target)})}if(t.paginator.firstLast){t.table.querySelector("*[first-page]").addEventListener("click",function(){t.paginate("first")});t.table.querySelector("*[last-page]").addEventListener("click",function(){t.paginate("last")})}if(t.paginator.prevNext){t.table.querySelector("*[prev-page]").addEventListener("click",function(){t.paginate("prev")});t.table.querySelector("*[next-page]").addEventListener("click",function(){t.paginate("next")})}t.page=t.table.querySelector("*[page]"),t.pageClone=t.page.cloneNode(!0),t.page.style.display="none"}(),{on:t.on,addFormatter:t.addFormatter,flush:t.flush,addLine:t.addLine,addLines:t.addLines,request:t.request,hideColumn:t.hideColumn,showColumn:t.showColumn,setPagination:function(e){t.pagination=e,t.updatePagination()},setPaginationHandler:function(e){t.paginationHandler=e},setResponseHandler:function(e){t.responseHandler=e},setSortingHandler:function(e){t.sortingHandler=e},setRequestHandler:function(e){t.requestHandler=e},init:function(){t.request()}}};!function(){var e=document.createElement("style");e.innerHTML='.tabling-sort-none::{content: "";}.tabling-sort-asc::after{content:" \\2193"}.tabling-sort-desc::after{content:" \\2191"}',document.body.appendChild(e)}();